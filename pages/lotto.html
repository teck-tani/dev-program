<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로또 번호 생성기 | 무료 로또 번호 추천 | Tani DevTool</title>
    <meta name="description" content="로또 번호 생성기를 이용하여 무료로 당첨 확률을 높일 수 있는 랜덤 번호를 생성해보세요. 역대 당첨 번호 확인 및 통계 기반 로또 분석 서비스도 제공합니다.">
    <meta name="keywords" content="로또 번호 생성기, 로또, 로또 번호 추천, 로또 당첨 번호, 로또 통계, 로또 분석, 무료 로또, 로또 예측">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tani-devtool.netlify.app/pages/lotto.html">
    <meta property="og:title" content="로또 번호 생성기 | 무료 로또 번호 추천">
    <meta property="og:description" content="로또 번호 생성기를 이용하여 무료로 당첨 확률을 높일 수 있는 번호를 생성해보세요. 역대 당첨 번호 확인과 통계 분석 기능 제공.">
    <meta property="og:image" content="https://tani-devtool.netlify.app/images/lotto-preview.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://tani-devtool.netlify.app/pages/lotto.html">
    
    <!-- Robots meta tag -->
    <meta name="robots" content="index, follow">
    
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* 메인 컨테이너 스타일 */
        .lotto-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        .section-title {
            text-align: center;
            margin: 30px 0 20px;
            color: #333;
            font-weight: 700;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 50px;
            height: 3px;
            background: linear-gradient(to right, #74ebd5, #ACB6E5);
            margin: 10px auto 0;
        }
        
        /* 번호 생성 섹션 */
        .generator-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .generate-button {
            background: linear-gradient(to right, #74ebd5, #ACB6E5);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
            font-weight: 500;
        }
        
        .generate-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(0,0,0,0.1);
        }
        
        .generate-button:active {
            transform: translateY(1px);
        }
        
        .lotto-balls-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            min-height: 80px;
            perspective: 600px;
        }
        
        .lotto-ball {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5rem;
            color: white;
            margin: 0 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: relative;
            opacity: 0;
            transform: scale(0.5) translateY(30px);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .lotto-ball.drawn {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
        
        .lotto-ball::after {
            content: '';
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 10px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
        }
        
        /* 로또 볼 번호별 색상 */
        .ball-1-10 { background: #fbc400; }
        .ball-11-20 { background: #69c8f2; }
        .ball-21-30 { background: #ff7272; }
        .ball-31-40 { background: #aaa; }
        .ball-41-45 { background: #b0d840; }
        
        /* 로또 애니메이션 컨테이너 */
        .animation-container {
            position: relative;
            height: 200px;
            margin-top: 20px;
            overflow: hidden;
            background: #f9f9f9;
            border-radius: 10px;
            display: none;
        }
        
        .lottery-machine {
            position: relative;
            width: 300px;
            height: 150px;
            margin: 0 auto;
            border-radius: 150px 150px 0 0;
            background: rgba(0, 0, 0, 0.05);
            overflow: hidden;
            margin-top: 25px;
        }
        
        .balls-jumble {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .jumble-ball {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            position: absolute;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .tube {
            position: absolute;
            width: 60px;
            height: 80px;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.1);
            border-radius: 30px 30px 0 0;
        }
        
        .animation-ball {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            position: absolute;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            opacity: 0;
        }
        
        /* 역대 당첨 번호 섹션 */
        .history-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .round-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .round-selector select {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            width: 200px;
        }
        
        .winning-numbers {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .winning-round-info {
            width: 100%;
            text-align: center;
            margin-bottom: 15px;
            font-weight: 500;
            color: #555;
        }
        
        /* 통계 섹션 */
        .stats-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 25px;
        }
        
        .stats-title {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 500;
        }
        
        .frequent-numbers {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        .frequent-number {
            display: flex;
            align-items: center;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 5px;
        }
        
        .number-ball {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: white;
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        .number-stats {
            display: flex;
            flex-direction: column;
            font-size: 0.9rem;
        }
        
        .number-frequency {
            font-weight: 700;
            color: #333;
        }
        
        .number-probability {
            color: #777;
            font-size: 0.8rem;
        }
        
        /* 반응형 */
        @media (max-width: 768px) {
            .lotto-ball {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
                margin: 0 5px;
            }
            
            .frequent-numbers {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .lottery-machine {
                width: 250px;
                height: 125px;
            }
        }
        
        @media (max-width: 480px) {
            .lotto-ball {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
                margin: 0 3px;
            }
            
            .frequent-numbers {
                grid-template-columns: repeat(1, 1fr);
            }
            
            .lottery-machine {
                width: 200px;
                height: 100px;
            }
        }
        
        /* 꿈 정보 및 선호 번호 입력 폼 */
        .user-preferences {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .form-group textarea {
            height: 80px;
            resize: vertical;
        }
        
        .preferred-numbers {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .number-checkbox {
            display: none;
        }
        
        .number-label {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            color: #555;
            border: 2px solid #ddd;
            transition: all 0.2s ease;
        }
        
        .number-checkbox:checked + .number-label {
            background: linear-gradient(to right, #74ebd5, #ACB6E5);
            color: white;
            border-color: transparent;
        }
        
        /* 번호 설명 스타일 */
        .number-explanation {
            margin-top: 30px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .explanation-title {
            font-weight: 700;
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1rem;
        }
        
        .number-details {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        
        .number-detail-item {
            flex: 1 1 calc(33.333% - 15px);
            min-width: 180px;
            background: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .detail-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .detail-ball {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            margin-right: 10px;
        }
        
        .detail-stats {
            font-size: 0.85rem;
            color: #555;
        }
        
        .detail-reason {
            font-size: 0.9rem;
            margin-top: 10px;
            color: #666;
            line-height: 1.4;
        }
        
        .probability-bar {
            height: 6px;
            background: #e9e9e9;
            border-radius: 3px;
            margin-top: 8px;
            overflow: hidden;
        }
        
        .probability-fill {
            height: 100%;
            background: linear-gradient(to right, #74ebd5, #ACB6E5);
        }
    </style>
</head>
<body>
    <!-- top-container가 로드될 자리 -->
    <div id="top-container"></div>
    
    <div class="lotto-container">
        <h1 class="section-title">로또 번호 생성기</h1>
        
        <!-- 번호 생성 섹션 -->
        <div class="generator-section">
            <h2>행운의 로또 번호 생성</h2>
            
            <!-- 사용자 선호도 입력 폼 -->
            <div class="user-preferences">
                <div class="form-group">
                    <label for="dreamInfo">꿈 정보 (선택사항)</label>
                    <textarea id="dreamInfo" placeholder="최근에 꾼 꿈에 대해 간략히 설명해주세요. 꿈 속 장소, 사물, 감정 등이 번호 생성에 반영됩니다."></textarea>
                </div>
                
                <div class="form-group">
                    <label>포함하고 싶은 번호 (최대 5개)</label>
                    <div class="preferred-numbers" id="preferredNumbersContainer">
                        <!-- 번호는 JavaScript로 동적 생성 -->
                    </div>
                </div>
            </div>
            
            <p>아래 버튼을 클릭하여 로또 번호 6개를 무작위로 생성해보세요!</p>
            
            <button id="generateButton" class="generate-button">
                <i class="fas fa-random"></i> 번호 추출하기
            </button>
            
            <!-- 로또 볼 애니메이션 컨테이너 -->
            <div class="animation-container" id="animationContainer">
                <div class="lottery-machine">
                    <div class="balls-jumble" id="ballsJumble"></div>
                    <div class="tube"></div>
                </div>
            </div>
            
            <div class="lotto-balls-container" id="lottoBallsContainer">
                <!-- 로또 볼이 여기에 표시됩니다 -->
            </div>
            
            <!-- 번호 설명 섹션 -->
            <div class="number-explanation" id="numberExplanation" style="display: none;">
                <h3 class="explanation-title">번호 분석 결과</h3>
                <p>선택된 번호에 대한 분석 결과와 확률 정보입니다.</p>
                
                <div class="number-details" id="numberDetails">
                    <!-- 번호 상세 설명은 JavaScript로 동적 생성 -->
                </div>
            </div>
        </div>
        
        <!-- 역대 당첨 번호 섹션 -->
        <h2 class="section-title">역대 1등 당첨 번호</h2>
        <div class="history-section">
            <div class="round-selector">
                <select id="roundSelector">
                    <option value="">회차를 선택하세요</option>
                    <!-- 회차 옵션은 JavaScript로 추가됩니다 -->
                </select>
            </div>
            
            <div class="winning-numbers" id="winningNumbers">
                <!-- 선택한 회차의 당첨 번호가 여기에 표시됩니다 -->
                <p class="winning-round-info">회차를 선택하면 당첨 번호가 표시됩니다.</p>
            </div>
        </div>
        
        <!-- 통계 섹션 -->
        <h2 class="section-title">로또 번호 통계 분석</h2>
        <div class="stats-section">
            <p class="stats-title">가장 많이 당첨된 번호 TOP 20</p>
            
            <div class="frequent-numbers" id="frequentNumbers">
                <!-- 자주 나오는 번호 통계가 여기에 표시됩니다 -->
                <p>통계 데이터를 불러오는 중입니다...</p>
            </div>
        </div>
    </div>
    
    <!-- 방명록 섹션 -->
    <section class="comments-section">
        <div class="container">
            <div class="comments-container">
                <div id="disqus_thread"></div>
            </div>
        </div>
    </section>
    
    <!-- footer-container가 로드될 자리 -->
    <div id="footer-container"></div>
    
    <script src="../js/common.js"></script>
    <script>
        // 로또 데이터 관리 및 자동화
        const LottoDataManager = {
            // JSON 파일 경로
            JSON_FILE_PATH: '../data/lotto/lottoData.json',
            
            // 로컬 스토리지 키
            LAST_CHECK_KEY: 'lotto_last_check',
            
            // 로또 데이터 가져오기
            loadData: async function() {
                try {
                    const response = await fetch(this.JSON_FILE_PATH);
                    if (!response.ok) {
                        throw new Error(`JSON 파일을 불러오는데 실패했습니다: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    // 최신 데이터부터 표시하기 위해 내림차순 정렬
                    data.sort((a, b) => b.round - a.round);
                    return data;
                } catch (error) {
                    console.error('로또 데이터 로드 실패:', error);
                    throw error;
                }
            },
            
            // 현재 회차 계산 (첫 회차 2002-12-07에서 매주 1회차씩 증가)
            calculateCurrentRound: function() {
                const firstDrawDate = new Date('2002-12-07');
                const today = new Date();
                
                // 첫 회부터 지금까지의 주 수 계산
                const weeksElapsed = Math.floor((today - firstDrawDate) / (7 * 24 * 60 * 60 * 1000));
                
                // 첫 회차가 1회였으므로 +1
                return weeksElapsed + 1;
            },
            
            // 업데이트가 필요한지 확인
            needsUpdate: function() {
                const lastCheck = localStorage.getItem(this.LAST_CHECK_KEY);
                if (!lastCheck) return true;
                
                const lastCheckDate = new Date(lastCheck);
                const now = new Date();
                
                // 토요일 이후 처음 방문이면 업데이트 필요
                const lastCheckWeek = Math.floor(lastCheckDate.getTime() / (7 * 24 * 60 * 60 * 1000));
                const currentWeek = Math.floor(now.getTime() / (7 * 24 * 60 * 60 * 1000));
                
                // 마지막 체크 이후 새로운 주가 시작됐고, 현재 날짜가 일요일(0) 이후라면 업데이트 필요
                const isNewWeek = lastCheckWeek < currentWeek;
                const isAfterSaturday = now.getDay() >= 0; // 일요일(0) 이후라면 토요일(6) 추첨 이후로 판단
                
                return isNewWeek && isAfterSaturday;
            },
            
            // 업데이트 날짜 기록
            updateLastCheckDate: function() {
                localStorage.setItem(this.LAST_CHECK_KEY, new Date().toISOString());
            },
            
            // API에서 특정 회차 데이터 가져오기
            fetchRoundData: async function(round) {
                try {
                    // 동행복권 API를 통해 데이터 가져오기
                    const response = await fetch(`https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo=${round}`);
                    const data = await response.json();
                    
                    // API 응답이 성공적인 경우에만 처리
                    if (data.returnValue === 'success') {
                        // 날짜 형식 변환
                        const drawDate = new Date(data.drwNoDate);
                        const formattedDate = drawDate.toISOString().split('T')[0];
                        
                        // 번호 추출 및 정렬
                        const numbers = [
                            data.drwtNo1, data.drwtNo2, data.drwtNo3,
                            data.drwtNo4, data.drwtNo5, data.drwtNo6
                        ].sort((a, b) => a - b);
                        
                        return {
                            round: data.drwNo,
                            date: formattedDate,
                            numbers: numbers,
                            bonus: data.bnusNo
                        };
                    }
                    
                    return null;
                } catch (error) {
                    console.error(`회차 ${round} 데이터 가져오기 실패:`, error);
                    return null;
                }
            }
        };
        
        document.addEventListener('DOMContentLoaded', async function() {
            const generateButton = document.getElementById('generateButton');
            const lottoBallsContainer = document.getElementById('lottoBallsContainer');
            const roundSelector = document.getElementById('roundSelector');
            const winningNumbers = document.getElementById('winningNumbers');
            const frequentNumbers = document.getElementById('frequentNumbers');
            const animationContainer = document.getElementById('animationContainer');
            const ballsJumble = document.getElementById('ballsJumble');
            const numberExplanation = document.getElementById('numberExplanation');
            const numberDetails = document.getElementById('numberDetails');
            const preferredNumbersContainer = document.getElementById('preferredNumbersContainer');
            const dreamInfo = document.getElementById('dreamInfo');
            
            // 선호 번호 선택 UI 생성
            function createPreferredNumbersUI() {
                preferredNumbersContainer.innerHTML = '';
                
                for (let i = 1; i <= 45; i++) {
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = `number-${i}`;
                    checkbox.className = 'number-checkbox';
                    checkbox.value = i;
                    
                    const label = document.createElement('label');
                    label.setAttribute('for', `number-${i}`);
                    label.className = 'number-label';
                    label.textContent = i;
                    
                    preferredNumbersContainer.appendChild(checkbox);
                    preferredNumbersContainer.appendChild(label);
                }
                
                // 최대 5개까지만 선택 가능하도록 제한
                preferredNumbersContainer.addEventListener('change', function(e) {
                    if (e.target.type === 'checkbox') {
                        const checkedBoxes = document.querySelectorAll('.number-checkbox:checked');
                        
                        if (checkedBoxes.length > 5) {
                            e.target.checked = false;
                            alert('최대 5개까지만 선택 가능합니다.');
                        }
                    }
                });
            }
            
            // 선호 번호 가져오기
            function getPreferredNumbers() {
                const checkedBoxes = document.querySelectorAll('.number-checkbox:checked');
                return Array.from(checkedBoxes).map(box => parseInt(box.value));
            }
            
            // 꿈 정보에서 키워드 추출
            function extractKeywordsFromDream() {
                const dreamText = dreamInfo.value.trim();
                if (!dreamText) return [];
                
                // 간단한 키워드 추출 (스페이스로 나누기)
                const words = dreamText.split(/\s+/).filter(word => word.length > 1);
                
                // 중복 제거 및 최대 10개 키워드 반환
                return [...new Set(words)].slice(0, 10);
            }
            
            // 꿈 키워드로부터 번호 생성
            function generateNumbersFromDream(keywords, existingNumbers) {
                const numbers = [...existingNumbers];
                
                if (keywords.length === 0) return numbers;
                
                // 단순한 해싱 알고리즘으로 키워드를 번호로 변환
                keywords.forEach(keyword => {
                    let hash = 0;
                    for (let i = 0; i < keyword.length; i++) {
                        hash = ((hash << 5) - hash) + keyword.charCodeAt(i);
                    }
                    
                    // 1~45 범위로 매핑
                    const number = Math.abs(hash % 45) + 1;
                    
                    // 중복되지 않는 경우에만 추가
                    if (!numbers.includes(number)) {
                        numbers.push(number);
                    }
                });
                
                return numbers;
            }
            
            // 로딩 표시
            const loadingElement = document.createElement('div');
            loadingElement.className = 'loading';
            loadingElement.textContent = '로또 데이터를 불러오는 중입니다...';
            winningNumbers.innerHTML = '';
            winningNumbers.appendChild(loadingElement);
            
            try {
                // 로또 데이터 로드
                let lottoData = await LottoDataManager.loadData();
                
                // 최신 회차와 다음 회차 계산
                const currentRound = LottoDataManager.calculateCurrentRound();
                const latestDataRound = lottoData[0].round;
                
                // 최신 데이터 확인 및 업데이트
                let dataUpdated = false;
                if (LottoDataManager.needsUpdate() && latestDataRound < currentRound) {
                    const statusElement = document.createElement('p');
                    statusElement.className = 'winning-round-info';
                    statusElement.textContent = '최신 당첨 정보를 확인하는 중입니다...';
                    
                    loadingElement.remove();
                    winningNumbers.appendChild(statusElement);
                    
                    // 빠진 회차 확인
                    const missingRounds = [];
                    for (let i = latestDataRound + 1; i <= currentRound; i++) {
                        if (!lottoData.some(item => item.round === i)) {
                            missingRounds.push(i);
                        }
                    }
                    
                    // 빠진 회차 데이터 가져오기
                    if (missingRounds.length > 0) {
                        for (const round of missingRounds) {
                            const newData = await LottoDataManager.fetchRoundData(round);
                            if (newData) {
                                lottoData.push(newData);
                                dataUpdated = true;
                                
                                // API 호출 사이에 지연 시간 추가 (서버 부하 방지)
                                await new Promise(resolve => setTimeout(resolve, 300));
                            }
                        }
                        
                        // 데이터 정렬
                        lottoData.sort((a, b) => b.round - a.round);
                        
                        // 업데이트 날짜 기록
                        LottoDataManager.updateLastCheckDate();
                    }
                }
                
                // 로딩 표시 제거
                winningNumbers.innerHTML = '';
                
                // 회차 선택 옵션 추가
                roundSelector.innerHTML = '<option value="">회차를 선택하세요</option>';
                lottoData.forEach(data => {
                    const option = document.createElement('option');
                    option.value = data.round;
                    option.textContent = `${data.round}회 (${data.date})`;
                    roundSelector.appendChild(option);
                });
                
                // 최신 정보 표시
                const statusElement = document.createElement('p');
                statusElement.className = 'winning-round-info';
                
                if (dataUpdated) {
                    statusElement.innerHTML = `최신 데이터로 업데이트되었습니다!<br>현재 <strong>${lottoData[0].round}회</strong>까지의 당첨 정보가 있습니다.`;
                } else {
                    statusElement.innerHTML = `현재 <strong>${lottoData[0].round}회</strong>까지의 당첨 정보가 있습니다.`;
                }
                
                winningNumbers.appendChild(statusElement);
                
                // 선호 번호 선택 UI 생성
                createPreferredNumbersUI();
                
                // 볼 색상 클래스 반환 함수
                function getBallColorClass(number) {
                    if (number <= 10) return 'ball-1-10';
                    if (number <= 20) return 'ball-11-20';
                    if (number <= 30) return 'ball-21-30';
                    if (number <= 40) return 'ball-31-40';
                    return 'ball-41-45';
                }
                
                // 번호 통계 데이터 계산
                function calculateNumberStats() {
                    // 모든 당첨 번호 수집
                    const allNumbers = lottoData.flatMap(data => data.numbers);
                    
                    // 각 번호별 빈도 계산
                    const numberFrequency = {};
                    for (let i = 1; i <= 45; i++) {
                        numberFrequency[i] = allNumbers.filter(num => num === i).length;
                    }
                    
                    // 총 회차 수
                    const totalDraws = lottoData.length;
                    
                    // 각 번호별 확률 계산
                    const numberProbability = {};
                    for (let i = 1; i <= 45; i++) {
                        numberProbability[i] = numberFrequency[i] / totalDraws;
                    }
                    
                    return {
                        frequency: numberFrequency,
                        probability: numberProbability,
                        totalDraws: totalDraws
                    };
                }
                
                // 번호가 선택된 이유 생성
                function generateNumberReason(number, stats, preferredNumbers, dreamKeywords) {
                    const reasons = [];
                    
                    // 사용자가 선택한 번호인 경우
                    if (preferredNumbers.includes(number)) {
                        reasons.push("사용자가 직접 선택한 번호입니다.");
                    }
                    
                    // 꿈 키워드와 관련된 번호인 경우
                    if (dreamKeywords.length > 0) {
                        // 해싱 로직으로 꿈 키워드 체크
                        for (const keyword of dreamKeywords) {
                            let hash = 0;
                            for (let i = 0; i < keyword.length; i++) {
                                hash = ((hash << 5) - hash) + keyword.charCodeAt(i);
                            }
                            const dreamNumber = Math.abs(hash % 45) + 1;
                            
                            if (dreamNumber === number) {
                                reasons.push(`"${keyword}" 키워드에서 유래한 번호입니다.`);
                                break;
                            }
                        }
                    }
                    
                    // 통계 기반 이유
                    const frequency = stats.frequency[number];
                    const probability = stats.probability[number];
                    const totalDraws = stats.totalDraws;
                    
                    if (frequency > totalDraws * 0.3) {
                        reasons.push(`매우 자주 등장하는 번호입니다 (${frequency}회).`);
                    } else if (frequency > totalDraws * 0.2) {
                        reasons.push(`평균보다 자주 등장하는 번호입니다 (${frequency}회).`);
                    } else if (frequency < totalDraws * 0.1) {
                        reasons.push(`희귀하게 등장하는 번호입니다 (${frequency}회).`);
                    }
                    
                    // 다른 이유가 없으면 기본 이유 추가
                    if (reasons.length === 0) {
                        reasons.push(`이 번호는 지금까지 ${frequency}회 당첨되었습니다.`);
                    }
                    
                    return reasons.join(' ');
                }
                
                // 번호 생성하기 버튼 클릭 이벤트
                generateButton.addEventListener('click', function() {
                    // 이미 진행 중인 애니메이션이 있다면 중단
                    if (generateButton.disabled) return;
                    
                    // 버튼 일시적으로 비활성화
                    generateButton.disabled = true;
                    
                    // 기존 공 제거
                    lottoBallsContainer.innerHTML = '';
                    
                    // 번호 설명 영역 숨기기
                    numberExplanation.style.display = 'none';
                    
                    // 애니메이션 컨테이너 표시
                    animationContainer.style.display = 'block';
                    ballsJumble.innerHTML = '';
                    
                    // 섞이는 공 애니메이션 생성
                    const allNumbers = Array.from({length: 45}, (_, i) => i + 1);
                    for (let i = 0; i < 30; i++) {
                        const randomNumber = allNumbers[Math.floor(Math.random() * 45)];
                        const ball = document.createElement('div');
                        ball.className = 'jumble-ball';
                        ball.textContent = randomNumber;
                        ball.classList.add(getBallColorClass(randomNumber));
                        
                        // 랜덤 위치
                        ball.style.left = `${Math.random() * 80 + 10}%`;
                        ball.style.top = `${Math.random() * 80 + 10}%`;
                        
                        // 랜덤 애니메이션
                        const animDuration = 0.5 + Math.random() * 1.5;
                        ball.style.animation = `jumble ${animDuration}s infinite alternate ease-in-out`;
                        ballsJumble.appendChild(ball);
                    }
                    
                    // 사용자가 선택한 번호 가져오기
                    const preferredNumbers = getPreferredNumbers();
                    
                    // 꿈 정보에서 키워드 추출
                    const dreamKeywords = extractKeywordsFromDream();
                    
                    // 번호 통계 계산
                    const numberStats = calculateNumberStats();
                    
                    // 랜덤 번호 생성 및 정렬
                    let availableNumbers = Array.from({length: 45}, (_, i) => i + 1)
                        .filter(num => !preferredNumbers.includes(num));
                    
                    // 꿈 키워드에서 번호 생성
                    const dreamNumbers = generateNumbersFromDream(dreamKeywords, preferredNumbers)
                        .filter(num => !preferredNumbers.includes(num));
                    
                    // 꿈에서 생성된 번호 제외
                    availableNumbers = availableNumbers.filter(num => !dreamNumbers.includes(num));
                    
                    // 선호 번호와 꿈 번호를 제외한 나머지는 랜덤 생성
                    const selectedNumbers = [...preferredNumbers, ...dreamNumbers];
                    
                    while (selectedNumbers.length < 6) {
                        // 가중치 부여: 자주 나온 번호에 더 높은 가중치
                        const weights = availableNumbers.map(num => 1 + numberStats.probability[num] * 5);
                        const totalWeight = weights.reduce((a, b) => a + b, 0);
                        
                        let random = Math.random() * totalWeight;
                        let selectedIndex = -1;
                        
                        for (let i = 0; i < weights.length; i++) {
                            random -= weights[i];
                            if (random <= 0) {
                                selectedIndex = i;
                                break;
                            }
                        }
                        
                        if (selectedIndex >= 0) {
                            const selectedNumber = availableNumbers[selectedIndex];
                            selectedNumbers.push(selectedNumber);
                            availableNumbers.splice(selectedIndex, 1);
                        }
                    }
                    
                    selectedNumbers.sort((a, b) => a - b);
                    
                    // 번호 상세 정보 생성
                    const numberDetailsHTML = selectedNumbers.map(number => {
                        const frequency = numberStats.frequency[number];
                        const probability = numberStats.probability[number];
                        const percentProbability = (probability * 100).toFixed(2);
                        const reason = generateNumberReason(number, numberStats, preferredNumbers, dreamKeywords);
                        
                        return `
                            <div class="number-detail-item">
                                <div class="detail-header">
                                    <div class="detail-ball ${getBallColorClass(number)}">${number}</div>
                                    <div class="detail-stats">
                                        <div>${frequency}회 당첨 (${percentProbability}%)</div>
                                        <div class="probability-bar">
                                            <div class="probability-fill" style="width: ${percentProbability * 2}%"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="detail-reason">${reason}</div>
                            </div>
                        `;
                    }).join('');
                    
                    // 공이 튀어나오는 애니메이션
                    setTimeout(() => {
                        // 애니메이션 컨테이너 숨기기
                        animationContainer.style.display = 'none';
                        
                        // 번호 표시
                        selectedNumbers.forEach((number, index) => {
                            const ball = document.createElement('div');
                            ball.className = 'lotto-ball';
                            ball.textContent = number;
                            ball.classList.add(getBallColorClass(number));
                            lottoBallsContainer.appendChild(ball);
                            
                            // 순차적으로 공 표시
                            setTimeout(() => {
                                ball.classList.add('drawn');
                            }, index * 300);
                        });
                        
                        // 번호 설명 표시
                        setTimeout(() => {
                            numberDetails.innerHTML = numberDetailsHTML;
                            numberExplanation.style.display = 'block';
                            
                            // 버튼 다시 활성화
                            generateButton.disabled = false;
                        }, 2000);
                    }, 2000);
                });
                
                // 회차 선택 이벤트
                roundSelector.addEventListener('change', function() {
                    const selectedRound = this.value;
                    if (selectedRound) {
                        const roundData = lottoData.find(data => data.round == selectedRound);
                        if (roundData) {
                            displayWinningNumbers(roundData);
                        }
                    } else {
                        winningNumbers.innerHTML = '<p class="winning-round-info">회차를 선택하면 당첨 번호가 표시됩니다.</p>';
                    }
                });
                
                // 당첨 번호 표시 함수
                function displayWinningNumbers(data) {
                    winningNumbers.innerHTML = '';
                    
                    const roundInfo = document.createElement('p');
                    roundInfo.className = 'winning-round-info';
                    roundInfo.textContent = `${data.round}회 (${data.date}) 당첨번호`;
                    winningNumbers.appendChild(roundInfo);
                    
                    // 당첨 번호 표시
                    data.numbers.forEach(number => {
                        const ball = document.createElement('div');
                        ball.className = 'lotto-ball drawn';
                        ball.textContent = number;
                        ball.classList.add(getBallColorClass(number));
                        winningNumbers.appendChild(ball);
                    });
                    
                    // 보너스 번호 구분자
                    const plusSign = document.createElement('div');
                    plusSign.textContent = '+';
                    plusSign.style.margin = '0 10px';
                    plusSign.style.fontSize = '1.5rem';
                    plusSign.style.fontWeight = 'bold';
                    winningNumbers.appendChild(plusSign);
                    
                    // 보너스 번호
                    const bonusBall = document.createElement('div');
                    bonusBall.className = 'lotto-ball drawn';
                    bonusBall.textContent = data.bonus;
                    bonusBall.classList.add(getBallColorClass(data.bonus));
                    bonusBall.style.backgroundColor = '#aaa';
                    winningNumbers.appendChild(bonusBall);
                }
                
                // 볼 색상 클래스 반환 함수
                function getBallColorClass(number) {
                    if (number <= 10) return 'ball-1-10';
                    if (number <= 20) return 'ball-11-20';
                    if (number <= 30) return 'ball-21-30';
                    if (number <= 40) return 'ball-31-40';
                    return 'ball-41-45';
                }
                
                // 번호 통계 계산 및 표시
                function calculateAndDisplayStats() {
                    // 모든 당첨 번호 수집
                    const allNumbers = lottoData.flatMap(data => data.numbers);
                    
                    // 각 번호별 빈도 계산
                    const numberFrequency = {};
                    for (let i = 1; i <= 45; i++) {
                        numberFrequency[i] = allNumbers.filter(num => num === i).length;
                    }
                    
                    // 빈도 기준으로 정렬하여 상위 20개 추출
                    const sortedNumbers = Object.entries(numberFrequency)
                        .sort((a, b) => b[1] - a[1])
                        .slice(0, 20);
                    
                    // 빈도 기반 확률 계산 (총 회차 대비 등장 비율)
                    const totalDraws = lottoData.length;
                    
                    // 통계 표시
                    frequentNumbers.innerHTML = '';
                    
                    sortedNumbers.forEach(([number, frequency]) => {
                        const probability = (frequency / totalDraws * 100).toFixed(1);
                        
                        const frequentItem = document.createElement('div');
                        frequentItem.className = 'frequent-number';
                        
                        const ball = document.createElement('div');
                        ball.className = `number-ball ${getBallColorClass(Number(number))}`;
                        ball.textContent = number;
                        
                        const stats = document.createElement('div');
                        stats.className = 'number-stats';
                        
                        const frequencyText = document.createElement('span');
                        frequencyText.className = 'number-frequency';
                        frequencyText.textContent = `${frequency}회 출현`;
                        
                        const probabilityText = document.createElement('span');
                        probabilityText.className = 'number-probability';
                        probabilityText.textContent = `확률: ${probability}%`;
                        
                        stats.appendChild(frequencyText);
                        stats.appendChild(probabilityText);
                        
                        frequentItem.appendChild(ball);
                        frequentItem.appendChild(stats);
                        
                        frequentNumbers.appendChild(frequentItem);
                    });
                }
                
                // 통계 데이터 표시
                calculateAndDisplayStats();
                
            } catch (error) {
                console.error('데이터 초기화 중 오류 발생:', error);
                winningNumbers.innerHTML = '<p class="winning-round-info">데이터를 불러오는 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.</p>';
            }
            
            // 애니메이션을 위한 CSS 추가
            const styleSheet = document.createElement('style');
            styleSheet.type = 'text/css';
            styleSheet.innerText = `
                @keyframes jumble {
                    0% { transform: translate(-10px, -10px); }
                    100% { transform: translate(10px, 10px); }
                }
            `;
            document.head.appendChild(styleSheet);
        });
    </script>
    
    <!-- Disqus 댓글 시스템 -->
    <script>
        var disqus_config = function () {
            this.page.url = window.location.href;
            this.page.identifier = 'lotto';
            this.page.title = document.title;
        };
        
        (function() {
            var d = document, s = d.createElement('script');
            s.src = 'https://tani-devtool.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>댓글을 보려면 자바스크립트를 활성화해주세요</noscript>
</body>
</html> 